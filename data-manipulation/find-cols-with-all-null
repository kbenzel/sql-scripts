SET NOCOUNT ON;

DECLARE @SCHEMA VARCHAR(20) = 'dbo';
DECLARE @TABLE VARCHAR(256) = 'tableName';
DECLARE @COLUMN VARCHAR(256) = (SELECT TOP 1 COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = @SCHEMA AND TABLE_NAME = @TABLE ORDER BY ORDINAL_POSITION)
DECLARE @SQL NVARCHAR(MAX);

IF OBJECT_ID('tempdb.dbo.#Data','U') IS NOT NULL DROP TABLE #Data
CREATE TABLE #Data(
	COLUMN_NAME VARCHAR(256),
	ORDINAL_POSITION INT,
	IS_NULLABLE VARCHAR(3),
	DATA_TYPE VARCHAR(50),
	ALL_NULL BIT DEFAULT 0,
	EXEC_STATEMENT NVARCHAR(MAX),
	IS_PROCESSED BIT DEFAULT 0);

INSERT INTO #Data
(COLUMN_NAME, ORDINAL_POSITION, IS_NULLABLE, DATA_TYPE, EXEC_STATEMENT)
SELECT	COLUMN_NAME,
		ORDINAL_POSITION,
		IS_NULLABLE,
		UPPER(DATA_TYPE),
		'IF NOT EXISTS(SELECT TOP 1 0 FROM ' + TABLE_SCHEMA + '.' + TABLE_NAME + ' WHERE ' + COLUMN_NAME + ' IS NOT NULL) 
			UPDATE #Data SET ALL_NULL = 1 WHERE COLUMN_NAME = ' + '''' + COLUMN_NAME + '''' + '; 
			UPDATE #Data SET IS_PROCESSED=1 WHERE COLUMN_NAME = ' + '''' + COLUMN_NAME + ''''
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_SCHEMA = @SCHEMA
	AND TABLE_NAME = @TABLE
ORDER BY ORDINAL_POSITION

SELECT @COLUMN = (SELECT TOP 1 COLUMN_NAME FROM #Data WHERE IS_PROCESSED = 0)
SELECT @SQL = (SELECT EXEC_STATEMENT FROM #Data WHERE COLUMN_NAME = @COLUMN)

WHILE 1=1
	BEGIN;
		EXEC (@SQL)
		
		RAISERROR(@COLUMN, 0, 1) WITH NOWAIT;

		SELECT @COLUMN = (SELECT TOP 1 COLUMN_NAME FROM #Data WHERE IS_PROCESSED = 0)
		SELECT @SQL = (SELECT EXEC_STATEMENT FROM #Data WHERE COLUMN_NAME = @COLUMN)

			IF @COLUMN IS NULL
				BREAK
	END;

SELECT * 
FROM #Data
