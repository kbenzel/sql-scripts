
SELECT	TABLE_NAME = MM.TABLE_NAME,
		MM.COLUMN_NAME,
		NULLABILITY_MISMATCH = CASE WHEN NULLABILITY_MISMATCH = 'Y' THEN 'database=' + AN.IS_NULLABLE + S1.IS_NULLABLE ELSE '' END,
		DATA_TYPE_MISMATCH = CASE WHEN DATA_TYPE_MISMATCH = 'Y' THEN 'database=' + AN.DATA_TYPE + S1.DATA_TYPE ELSE '' END,
		LENGTH_MISMATCH = CASE WHEN LENGTH_MISMATCH = 'Y' THEN 'database=' + CONVERT(VARCHAR, AN.CHARACTER_MAXIMUM_LENGTH) + CONVERT(VARCHAR, S1.CHARACTER_MAXIMUM_LENGTH) ELSE '' END,
		NUMERIC_PRECISION_MISMATCH = CASE WHEN NUMERIC_PRECISION_MISMATCH = 'Y' THEN 'database=' + CONVERT(VARCHAR, AN.NUMERIC_PRECISION) + CONVERT(VARCHAR, S1.NUMERIC_PRECISION) ELSE '' END,
		DATETIME_PRECISION_MISMATCH = CASE WHEN DATETIME_PRECISION_MISMATCH = 'Y' THEN 'database=' + CONVERT(VARCHAR, AN.DATETIME_PRECISION) + CONVERT(VARCHAR, S1.DATETIME_PRECISION) ELSE '' END
FROM (

		SELECT	T.TABLE_NAME, 
				T.COLUMN_NAME, 
				NULLABILITY_MISMATCH = CASE WHEN AN.IS_NULLABLE <> S1.IS_NULLABLE THEN 'Y' ELSE '' END,
				DATA_TYPE_MISMATCH = CASE WHEN AN.DATA_TYPE <> S1.DATA_TYPE THEN 'Y' ELSE '' END,
				LENGTH_MISMATCH = CASE WHEN AN.CHARACTER_MAXIMUM_LENGTH <> S1.CHARACTER_MAXIMUM_LENGTH THEN 'Y' ELSE '' END,
				NUMERIC_PRECISION_MISMATCH = CASE WHEN AN.NUMERIC_PRECISION <> S1.NUMERIC_PRECISION THEN 'Y' ELSE '' END,
				DATETIME_PRECISION_MISMATCH = CASE WHEN AN.DATETIME_PRECISION <> S1.DATETIME_PRECISION THEN 'Y' ELSE '' END
		FROM (
				SELECT T.TABLE_NAME, C.COLUMN_NAME
				FROM [database1].INFORMATION_SCHEMA.Tables AS T
					INNER JOIN [database1].INFORMATION_SCHEMA.COLUMNS AS C ON T.TABLE_NAME = C.TABLE_NAME
				WHERE T.TABLE_TYPE = 'BASE TABLE'
					--AND T.TABLE_SCHEMA = 'dbo'

				INTERSECT

				SELECT T.TABLE_NAME, C.COLUMN_NAME
				FROM [database2].INFORMATION_SCHEMA.Tables AS T
					INNER JOIN [database2].INFORMATION_SCHEMA.COLUMNS AS C ON T.TABLE_NAME = C.TABLE_NAME
				WHERE T.TABLE_TYPE = 'BASE TABLE'
					--AND T.TABLE_SCHEMA = 'dbo'
			) AS T
		INNER JOIN [database1].INFORMATION_SCHEMA.COLUMNS AS AN ON T.TABLE_NAME = AN.TABLE_NAME AND T.COLUMN_NAME = AN.COLUMN_NAME
		INNER JOIN [database2].INFORMATION_SCHEMA.COLUMNS AS S1 ON T.TABLE_NAME = S1.TABLE_NAME AND T.COLUMN_NAME = S1.COLUMN_NAME

	) AS MM
		INNER JOIN [database1].INFORMATION_SCHEMA.COLUMNS AS AN ON MM.TABLE_NAME = AN.TABLE_NAME AND MM.COLUMN_NAME = AN.COLUMN_NAME
		INNER JOIN [database2].INFORMATION_SCHEMA.COLUMNS AS S1 ON MM.TABLE_NAME = S1.TABLE_NAME AND MM.COLUMN_NAME = S1.COLUMN_NAME

WHERE NULLABILITY_MISMATCH = 'Y'
	OR DATA_TYPE_MISMATCH = 'Y'
	OR LENGTH_MISMATCH = 'Y'
	OR NUMERIC_PRECISION_MISMATCH = 'Y'
	OR DATETIME_PRECISION_MISMATCH = 'Y'
